<?xml version="1.0" encoding="UTF-8"?>
<phase_execution>

  <metadata>
    <phase>2</phase>
    <name>Task Execution Loop</name>
    <version>4.0</version>
    <architecture>MASTER_PROTOCOL_REFERENCE</architecture>
  </metadata>

  <important_notice>
    <message>PHASE 2 EXECUTION IS NOW HANDLED IN MASTER PROTOCOL</message>
    <reference>execute-tasks-master.xml contains all Phase 2 logic</reference>
    <instruction>DO NOT execute this file directly - use execute-tasks.xml instead</instruction>
  </important_notice>
  
  <phase2_summary>
    <description>Phase 2 handles task execution loop with these concrete steps:</description>
    
    <wallaby_check>
      <tool>mcp__wallaby__wallaby_failingTests</tool>
      <purpose>Optional check for failing tests before task execution</purpose>
    </wallaby_check>
    
    <execution_loop>
      <description>FOR EACH INCOMPLETE TASK IN TASKS.MD:</description>
      
      <step1>
        <name>Announce Task</name>
        <action>Output current task being executed</action>
      </step1>
      
      <step2>
        <name>Update Todo In Progress</name>
        <tool>TodoWrite</tool>
        <action>Mark current task as in_progress</action>
      </step2>
      
      <step3>
        <name>Execute Task Work</name>
        <tool_selection>Edit/Write for code, Read for files, Bash for tests/git, Grep/Glob for search</tool_selection>
        <action>Perform the actual work required for this task</action>
      </step3>
      
      <step4>
        <name>Mark Complete in File</name>
        <tool>Edit</tool>
        <target>${SPEC_PATH}/tasks.md</target>
        <change>- [ ] to - [x]</change>
      </step4>
      
      <step5>
        <name>Update Todo Complete</name>
        <tool>TodoWrite</tool>
        <action>Mark current task as completed</action>
      </step5>
      
      <step6>
        <name>Announce Completion</name>
        <action>Output task completion message</action>
      </step6>
    </execution_loop>
    
  </phase2_summary>

  <completion_criteria>
    <trigger>All tasks in tasks.md marked [x] AND TodoWrite updated</trigger>
    <signal>Phase 2 completion message in master protocol</signal>
    <next_action>Automatic progression to Phase 3</next_action>
  </completion_criteria>

  <integration_note>
    <master_file>execute-tasks-master.xml</master_file>
    <section>phase_2_execution</section>
    <contains>Concrete task execution loop and tool selection logic</contains>
  </integration_note>

</phase_execution>