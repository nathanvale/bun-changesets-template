# Task 026: Establish adapter fakes for external services (email, S3, etc.)

**Epic:** reduce-insane-mock-usage **Phase:** Phase 3 - Architecture
Transformation **Created:** 2025-09-20T02:15:00Z **Updated:**
2025-09-20T02:15:00Z **Status:** pending **Size:** Large **Parallel:** true
**Depends on:** [021]

## Objective

Create comprehensive fake implementations for all external service adapters that
provide realistic behavior without external dependencies, enabling reliable and
fast testing of business logic that depends on external services.

## Success Criteria

- [ ] Fake implementations created for all external service adapters
- [ ] Fakes provide realistic behavior and error scenarios
- [ ] State management implemented for stateful services
- [ ] Configuration system for controlling fake behavior
- [ ] Performance comparable to or better than mocked services
- [ ] Integration with test frameworks for easy usage

## Tasks

1. **Design fake implementation patterns**
   - Establish consistent patterns for fake service implementations
   - Define configuration interfaces for controlling fake behavior
   - Create base classes for common fake service patterns

2. **Implement email service fakes**
   - Create fake email adapter with message storage
   - Implement delivery failure simulation
   - Add email content validation and assertion utilities

3. **Implement storage service fakes**
   - Create fake S3/cloud storage with in-memory or temp file backend
   - Implement upload/download with realistic latency simulation
   - Add storage quota and error scenario simulation

4. **Implement external API fakes**
   - Create fakes for third-party API services
   - Implement rate limiting and authentication simulation
   - Add configurable response delays and error conditions

5. **Add fake service utilities**
   - Create test utilities for configuring and controlling fakes
   - Implement assertion helpers for verifying service interactions
   - Add state inspection utilities for debugging test failures

## Architecture Impact

- Eliminates dependency on external services for testing
- Provides consistent and reliable test execution
- Enables testing of edge cases and error scenarios
- Reduces test execution time and external service costs

## Testing Strategy

- Fakes that closely mimic real service behavior
- Configurable error scenarios for resilience testing
- State inspection for verifying service interactions
- Performance benchmarks to ensure fakes don't slow tests

## Notes

- Depends on adapter interfaces from task 021
- Focus on realistic behavior rather than perfect simulation
- Ensure fakes can be easily configured for different test scenarios
