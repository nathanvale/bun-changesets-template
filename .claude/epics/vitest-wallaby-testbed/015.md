---
name: Align CLI helper semantics
status: open
created: 2025-09-20T21:07:43Z
updated: 2025-09-21T00:00:00Z
github: # Will be updated when synced to GitHub
depends_on: [013]
parallel: true
conflicts_with: []
---

# Task: Align CLI helper semantics

## Description

Fix the API mismatch where `quickMocks` only registers spawn mocks while tests expect exec/execSync functionality. Decide on consistent behavior and update either the helpers or documentation to match actual usage.

## Acceptance Criteria

- [ ] Decision made: tri-register by default (spawn, exec, execSync) with option to limit
- [ ] Helper functions updated to tri-register by default and expose flags to narrow scope
- [ ] All mock registration methods consistent
- [ ] Test expectations align with helper behavior
- [ ] No undefined Buffer returns from exec/execSync
- [ ] Documentation clearly states what each helper provides
- [ ] TypeScript types reflect default tri-register behavior and optional narrowing

## Technical Details

- Review current quickMocks implementation
- Analyze test usage patterns for exec vs spawn
- Expand quickMocks to register all three methods by default
- Provide optional config to scope to spawn-only or exec-only when needed
- Update TypeScript types to reflect actual behavior

Key files affected:

- `packages/testkit/src/cli/spawn.ts` (if quickMocks currently live here)
- `packages/testkit/src/cli/process-mock.ts`
- Test files using CLI mocks
- Documentation and examples

## Dependencies

- [ ] Task 013: Need new mock factory structure
- [ ] Analysis of current test usage patterns

## Effort Estimate

- Size: S
- Hours: 4-6
- Parallel: true (can work alongside Task 014)

## Definition of Done

- [ ] Helper semantics clearly defined
- [ ] Implementation matches documentation
- [ ] All CLI mock methods properly registered
- [ ] Tests updated to use correct helpers
- [ ] No undefined returns from mock methods
- [ ] TypeScript types accurate
- [ ] Documentation updated with clear examples
