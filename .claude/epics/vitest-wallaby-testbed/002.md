---
task_id: 002
name: Implement MSW server configuration
description: Set up Mock Service Worker for HTTP/API mocking in tests
status: closed
priority: high
tags: msw, mocking, http
created: 2025-09-20T03:22:42Z
updated: 2025-09-20T04:53:45Z
---

# Task 002: Implement MSW server configuration

## Description

Create the MSW (Mock Service Worker) server configuration for intercepting and mocking HTTP requests in both unit and integration tests.

## Acceptance Criteria

- [ ] Create MSW server instance for Node.js environment
- [ ] Implement default handlers for common scenarios
- [ ] Set up proper lifecycle hooks (beforeAll, afterEach, afterAll)
- [ ] Configure strict mode with `onUnhandledRequest: 'error'`
- [ ] Create utility functions for common mocking patterns

## Technical Details

### File: `packages/testkit/src/msw/node-server.ts`
```typescript
import { setupServer } from 'msw/node'
import { http, HttpResponse } from 'msw'

export const server = setupServer(
  // Default handlers here
)

// Strict mode configuration
server.listen({ onUnhandledRequest: 'error' })
```

### File: `packages/testkit/src/msw/handlers.ts`
- Common response builders
- Error simulation helpers
- Delay simulation utilities
- Authentication mock helpers

## Implementation Notes

- Use REST API handlers by default
- Support GraphQL handlers as needed
- Ensure handlers can be easily overridden in tests
- Provide type-safe mock data builders
- Document common patterns for 3rd-party API mocking