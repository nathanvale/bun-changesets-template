---
task_id: 006
name: Configure Vitest base settings
description: Create standardized Vitest configuration for all packages
status: todo
priority: high
tags: vitest, configuration, testing
created: 2025-09-20T03:22:42Z
---

# Task 006: Configure Vitest base settings

## Description

Create a base Vitest configuration that all packages can extend, ensuring consistent test behavior across the monorepo.

## Acceptance Criteria

- [ ] Create base vitest.config.ts template
- [ ] Configure pool: 'forks' for stability
- [ ] Set up proper isolation and cleanup
- [ ] Configure Wallaby-compatible settings
- [ ] Implement environment detection

## Technical Details

### File: `packages/testkit/src/config/vitest.base.ts`
```typescript
import { defineConfig } from 'vitest/config'

export const baseConfig = defineConfig({
  test: {
    setupFiles: ['@workspace/testkit/register'],
    environment: 'node',
    pool: 'forks',
    isolate: true,
    bail: 1,
    teardownTimeout: 20_000,
    env: { NODE_ENV: 'test' }
  }
})
```

### Configuration Options
- Pool strategy (forks vs threads vs vmThreads)
- Isolation levels
- Timeout configurations
- Reporter settings
- Coverage configuration

## Implementation Notes

- Ensure compatibility with Wallaby's auto-detection
- Optimize for fast feedback in watch mode
- Configure different settings for CI vs local
- Support both Node and jsdom environments
- Document performance implications of each setting